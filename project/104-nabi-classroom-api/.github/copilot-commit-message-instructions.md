# Git Commit Message 生成規則

## 輸出格式（嚴格遵守）
```
feat: <單號> <任務名稱>
<變更記錄>
```

## 規則說明

### **單號提取**
- 從分支名稱提取，格式：`分支類型/單號`
- 範例：`feature/NABI-543` → 單號為 `NABI-543`
- 若無法提取則使用 `UNKNOWN`

### **任務名稱**
- 優先使用提供的任務描述
- 若無提供則使用預設格式：`功能開發` 或 `程式修改`

### **變更記錄格式**
```
<序號>. <類型>: <模組> <說明>
```

#### **類型定義**
- `新增`：新建檔案，新的函式，新的API，新的Model
- `修改`：修改現有檔案，修正錯誤，優化邏輯

#### **模組命名規則**
| 路徑範例                    | 模組名稱              |
| --------------------------- | --------------------- |
| `api_ap/ability/*.py`       | `api_ap/ability`      |
| `api_user/*.py`             | `api_user`            |
| `services/notify_v2/*.py`   | `services/notify_v2`  |
| `frontend/components/*.js`  | `frontend/components` |
| `database/migrations/*.sql` | `database/migrations` |

**規則**：取到倒數第二層目錄，去除檔案名稱

#### **說明撰寫**
- 每項不超過 15 字
- 描述功能異動，非技術細節
- 同模組可分多項說明

## 範例輸出

### 範例 1：功能開發
```
feat: NABI-543 新增技能管理功能
1. 新增: api_ap/ability 技能匯入API
2. 修改: ability 增加類型欄位  
3. 修改: ability 資料過濾邏輯
```

### 範例 2：修復問題
```
feat: NABI-789 修正使用者驗證
1. 修改: api_user 修正登入邏輯
2. 修改: services/auth 加強安全驗證
```

### 範例 3：複雜變更
```
feat: NABI-456 優化通知系統
1. 新增: services/notify_v2 建立新通知服務
2. 修改: api_user 整合通知功能
3. 修改: frontend/components 更新通知顯示
4. 修改: database/migrations 新增通知表格
```

## 約束條件
- 必須嚴格按照格式輸出
- 序號從 1 開始遞增
- 每個有變更的模組都必須列出
- 若資訊不足，使用預設值而非跳過
- 變更記錄依模組類型分組排列（新增在前，修改在後）

## 輸出前檢查清單
- □ 格式是否正確
- □ 單號是否正確提取
- □ 所有變更模組是否都已列出  
- □ 說明是否簡潔明瞭（25字內）
- □ 序號是否連續遞增

## 錯誤處理
- 分支名稱格式錯誤 → 使用 `UNKNOWN` 作為單號
- 無任務描述 → 使用 `功能異動` 作為預設
- 無法解析模組 → 使用完整路徑
- 空的變更清單 → 輸出 `無程式異動`