我需要整理一份工程的提案，跟主管與企劃說明相關的運作

主題是：活動入場驗票機制與流程

## 需求
### 上次舉辦活動之檢討與痛點
1. 由工作人員拿著手機掃描很累，且需要很多工作人員
2. 因為只有單一種票券，但因為無法分出不同入口，所以沒辦法用資料統計出不同入口的入場人數


## 提案細節如下
### 活動現場狀況
1. 機器改成手機/平板，固定於檯面，裝上掃描器行動電源與行動電源
2. 活動網站提供新的掃描功能連結入口，工作人員可用手機/平板開啟，也會qr code話增加易用性
3. 進入功能時，需輸入該裝置所在位置編號，例如：A門入口-1、A門入口-2、B門入口-3
4. 掃描待機時，畫面大字顯示該裝置位置編號與裝置狀態(例如：A門入口-1)    
5. 掃描成功時，畫面顯示該票券資訊與入場成功，畫面盡量簡潔易懂，且有明顯顏色區隔，有聲音提示，提示玩數秒後自動回到待機畫面
6. 掃描失敗時，畫面顯示失敗，畫面盡量簡潔易懂，且有明顯顏色區隔，有聲音提示，提示玩數秒後自動回到待機畫面
7. 無論在哪個畫面，只要沒有正在處理的驗票，都可以馬上掃下一個票券
8. 禁止「瀏覽器返回」造成狀態錯亂：用全螢幕 Web App / 禁止回上一頁等前端控制
9. 當有錯誤發生的時候，工作人員再上前引導到旁邊協助，可以使用舊流程，就可以看到比較詳細的驗票錯誤細節
10. 當需要將裝置移轉使用的時候，要登出授權夜再進入，登出方式為短時間連續點擊畫面特定區域9次，並跳出提示確認

### 工程細節
1. 開發新的進入掃描功能頁管理功能，產生授權功能網頁網址，該網址可以被重置，重置後原網址失效，但已授權的裝置仍可繼續使用
2. 當裝置登入需提供位置編號，由授權頁提供一個長時間不過期的id當作裝置識別碼，由授權頁提供裝置授權碼，之後的驗票行為都帶著該授權碼，可用JWT
3. 裝置登入後，該授權碼也會在活動後台有對應的條目，可以從後台取消授權
4. 裝置登入時，會檢查使否有重複的已生效位置編號+裝置識別碼組合，若有則代表是原裝置重新登入，若位置編號重複但裝置不同要跳出警告  
5. 每次驗票都會檢查機器識別碼與授權碼是否正確
6. 每次驗票都會寫入一筆log，包含活動id、場次id、驗票時間、票券編號、裝置授權碼、位置編號、驗票結果，同時更新報到狀態

### 待處理討論
1. 定義「標準設備建議」文件：螢幕尺寸、作業系統版本、建議使用 Chrome / Safari。
2. 掃描方式不只限外接掃描器，保留「直接用鏡頭掃描」作為備援。


### gpt建議
1. 定義「標準設備建議」文件：螢幕尺寸、作業系統版本、建議使用 Chrome / Safari。
2. 掃描方式不只限外接掃描器，保留「直接用鏡頭掃描」作為備援。
3. 授權方式
    位置編號來源：應由後台事先配置（避免人工亂填）。登入流程安全性：避免「誰拿到網址就能亂掃」。
    具體調整建議：
   - 後台建立「裝置授權設定」頁：
   - 建立「入口位置列表」。
   - 每個位置產生「專用授權登入連結」或「一次性註冊碼」。
   - 首次登入：掃描「授權 QR Code」或輸入授權碼 → 綁定該位置＋產生裝置識別碼(Device ID)＋授權 Token。
   - 後續登入：裝置記住 Device ID＋長效 Token（例如使用 JWT：JSON Web Token），不需每次輸入位置。